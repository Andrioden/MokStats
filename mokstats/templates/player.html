{% extends "base.html" %} 

{% block title %}Enter{% endblock %}

{% block imports %}
	
{% endblock %} 

{% block content %}


	
	<!-- Start of first page -->
	<div data-role="page" id="player_page_{{name}}">
	
		<div data-role="header">
			<a href="../../" data-role="button" data-icon="home" data-iconpos="notext"></a>
			<a href="../" data-role="button" data-icon="back">Spillere</a>
			<h1>{{ name }}</h1>
		</div>
		
	
		<div data-role="content">
			<div class="center_outer">
				<div id="{{name}}_pie_graph" class="graph center_inner"></div>
				<div id="{{name}}_rating_graph" class="graph center_inner"></div>
			</div>
		
		</div>
		
		<script>
			$("#player_page_{{name}}").on('pageinit', function(){
				/*
				* This method is a semi-hax that attempts to init the graph in
				* an interval until it succeds. I was unable to trigger the method
				* at the correct time.
				*/
				var interval = setInterval(function(){
					initResultGraph("{{ name }}", {{ played }}, {{ won }}, {{ lost }});
					initRatingGraph("{{ name }}", {{ ratings|safe }});
					if ($("#{{ name }}_pie_graph").find('canvas').length > 0) {
						window.clearInterval(interval);		
					}
				},100);
				
			});
			
			function initResultGraph(name, played, won, lost) {
				var other = played - won - lost;
			    var s1 = [
			    	['Vunnet ('+won+')', won], 
			    	['Annet ('+other+')', other],
			    	['Tapt ('+lost+')', lost],
			    ];

			    var plot = $.jqplot(name+'_pie_graph', [s1], {
			    	title:'Resultater',
			    	seriesColors: ['#90EE90', '#F0F03F', '#FC7E7E'],
			        /*grid: {
			            drawBorder: false,
			            drawGridlines: false,
			            background: '#EEEEEE',
			            shadow:false
			        },*/
			        axesDefaults: {
			             
			        },
			        seriesDefaults:{
			            renderer:$.jqplot.PieRenderer,
			            rendererOptions: {
			                showDataLabels: true
			            }
			        },
			        legend: {
			            show: true,
			            rendererOptions: {
			                numberRows: 1
			            },
			            location: 's'
			        }
			    });
				
			    
			}
			
			function initRatingGraph(name, ratings) {
				var plot1 = $.jqplot(name+'_rating_graph', [ratings], {
					title:'Rating utvikling',
					axes:{
						xaxis:{
							renderer:$.jqplot.DateAxisRenderer,
							tickOptions:{
								formatString:'%b&nbsp;%#d'
							}
						},
						yaxis:{
							tickOptions:{
								formatString:'%.0f'
							}
						}
					},
					highlighter: {
						show: true,
						sizeAdjust: 7.5
					},
					cursor: {
				        show: true,
				        zoom:true,
					}
				});
			}
		</script>
		
		<script src="{{ STATIC_URL }}jqplot/jquery.jqplot.min.js"></script>
		<script src="{{ STATIC_URL }}jqplot/jqplot.pieRenderer.min.js"></script>
		<script src="{{ STATIC_URL }}jqplot/jqplot.highlighter.min.js"></script>
		<script src="{{ STATIC_URL }}jqplot/jqplot.cursor.min.js"></script>
		<script src="{{ STATIC_URL }}jqplot/jqplot.dateAxisRenderer.min.js"></script>
	</div>


{% endblock %}